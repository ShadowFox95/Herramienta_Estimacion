package com.becarios.proyecto_definitivo.service.criterios;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

<<<<<<< Upstream, based on origin/vista
import com.becarios.proyecto_definitivo.dao.ModuleDao;
=======
import com.becarios.proyecto_definitivo.dao.criterios.ModuleDao;
>>>>>>> 4d88fc0 a
import com.becarios.proyecto_definitivo.model.criterios.CUOriginal;
import com.becarios.proyecto_definitivo.model.criterios.Integracion;
import com.becarios.proyecto_definitivo.model.criterios.Modulo;
import com.becarios.proyecto_definitivo.model.criterios.Negocio;
import com.becarios.proyecto_definitivo.model.criterios.Perfiles;
import com.becarios.proyecto_definitivo.model.criterios.Persistencia;
import com.becarios.proyecto_definitivo.model.criterios.Tabla;
import com.becarios.proyecto_definitivo.model.criterios.Vista;

@Service("ModuleService")
@Transactional
public class ModuleServiceImpl implements ModuleService {

    @Autowired
    private ModuleDao dao;

    @Override
<<<<<<< Upstream, based on origin/vista
    public Modulo findByCode(String code) {
        return dao.findByCode(code);
=======
    public Modulo findByCode(int id) {
        return dao.findByCode(id);
>>>>>>> 4d88fc0 a
    }

    @Override
    public void saveModulo(Modulo modulo) {
        dao.saveModule(modulo);

    }

    @Override
    public void updateModulo(Modulo modulo) {
        Modulo entity = dao.findByCode(modulo.getCode());
        if (entity != null) {
            entity.setName(modulo.getName());
            entity.setCaseOfUse(modulo.getCaseOfUse());
            entity.setTablas(modulo.loadTablas());
            entity.setTotal(modulo.getTotal());
        }

    }

    @Override
<<<<<<< Upstream, based on origin/vista
    public void deleteModuloByCode(String code) {
        dao.deleteModuleByCode(code);
=======
    public void deleteModuloByCode(int id) {
        dao.deleteModuleByCode(id);
>>>>>>> 4d88fc0 a

    }

    @Override
<<<<<<< Upstream, based on origin/vista
    public List<Modulo> findAllModulo() {
        return dao.findAllModules();
=======
    public List<Modulo> findAllModulo(int id) {
        return dao.findAllModules(id);
    }

    @Override
    public void createModulo(int id) {

        Modulo m = new Modulo();

        
        m.setNombre("Nombre por defecto");
        m.setCodigo("Codigo"); // Autogenerated Value
        m.setModulo("Caso de uso" + " por defecto");
        m.setTotalFila(5);
        m.setIdProyecto(id);

>>>>>>> 4d88fc0 a
    }

    @Override
    public boolean isModuloCodeUnique(String code) {
        Modulo modulo = findByCode(code);
        return (modulo == null || ((code != null) && (modulo.getCode() == code)));
    }

<<<<<<< Upstream, based on origin/vista
    @Override
    public boolean AddModulo(String codigoProyecto, boolean editado, String code, String caseOfUse, String name,
            int perfilesTotal, int perfilesNro, int perfilesComplejidad, int vistaTotal, int vistaNro, int vistaCampos,
            int vistaComplejidad, int vistaListados, int vistaBotones, int negocioTotal, int negocioNro,
            int negocioLogica, int persistenciaTotal, int persistenciaNro, int persistenciaAccesos, int cuTotal,
            int cuDificultad, int integracionTotal, int integracionNro, int integracionComplejidad) {
=======
	@Override
	public boolean AddModulo(int idProyecto, int id, String code, String caseOfUse, String name, int perfilesTotal,
			int perfilesNro, int perfilesComplejidad, int vistaTotal, int vistaNro, int vistaCampos,
			int vistaComplejidad, int vistaListados, int vistaBotones, int negocioTotal, int negocioNro,
			int negocioLogica, int persistenciaTotal, int persistenciaNro, int persistenciaAccesos, int cuTotal,
			int cuDificultad, int integracionTotal, int integracionNro, int integracionComplejidad) {
>>>>>>> 4d88fc0 a
        try {
            // Crear el Objeto a Guardar
<<<<<<< Upstream, based on origin/vista
            Modulo modulo = new Modulo(codigoProyecto);
            modulo.setCode(code);
            modulo.setCaseOfUse(caseOfUse);
            modulo.setName(name);
=======
            Modulo modulo = new Modulo();
            modulo.setId(id);
            modulo.setModulo(caseOfUse);
            modulo.setNombre(name);
>>>>>>> 4d88fc0 a

            // Llamar al service para que lo guarde

            // Crea objeto Perfiles
            Perfiles perfiles = new Perfiles(code);
            perfiles.setCodigoRef(code);
            perfiles.setNro(perfilesNro);
            perfiles.setComplejidad(perfilesComplejidad);
            perfiles.setTotal(perfilesTotal);

            // Crea objeto Vista
            Vista vista = new Vista(code);
            vista.setCodigoRef(code);
            vista.setNro(vistaNro);
            vista.setBotones(vistaBotones);
            vista.setCampos(vistaCampos);
            vista.setComplejidad(vistaComplejidad);
            vista.setListados(vistaListados);
            vista.setTotal(vistaTotal);

            // Crea objeto Negocio
            Negocio negocio = new Negocio(code);
            negocio.setCodigoRef(code);
            negocio.setNro(negocioNro);
            negocio.setLogica(negocioLogica);
            negocio.setTotal(negocioTotal);

            // Crea objeto Persistencia
            Persistencia persistencia = new Persistencia(code);
            persistencia.setCodigoRef(code);
            persistencia.setNro(persistenciaNro);
            persistencia.setAccesos(persistenciaAccesos);
            persistencia.setTotal(persistenciaTotal);

            // Crea objeto CUOriginal
            CUOriginal cu = new CUOriginal(code);
            cu.setCodigoRef(code);
            cu.setDificultad(cuDificultad);
            cu.setTotal(cuTotal);

            // Crea objeto Integracion
            Integracion integracion = new Integracion(code);
            integracion.setCodigoRef(code);
            integracion.setNro(integracionNro);
            integracion.setComplejidad(integracionComplejidad);
            integracion.setTotal(integracionTotal);




            float total;
           //lo calcula el procedure de la base de datos.
              if (!true) {
                total = (float) ((perfilesTotal + vistaTotal + negocioTotal + persistenciaTotal) / 7);
            } else {
                total = (float) ((perfilesTotal + vistaTotal + negocioTotal + persistenciaTotal) * 0.8 / 7
                        + integracionTotal * 0.2);
            }

<<<<<<< Upstream, based on origin/vista
            modulo.setTotal(total);
=======
            //modulo.setTotal(total);
>>>>>>> 4d88fc0 a

            this.saveModulo(modulo);
            // Not implemented yet
            // dao.saveTablas(perfiles,vista,negocio,persistencia,cuoriginal,integracion)

        } catch (Exception e) {
            return false;
        }
        return true;
    }

<<<<<<< Upstream, based on origin/vista
    @Override
    public void createModulo(String codigoProyecto) {

        Modulo m = new Modulo(codigoProyecto);

        m.setName("Nombre por defecto");
        m.setCode("Codigo"); // Autogenerated Value
        m.setCaseOfUse("Caso de uso" + " por defecto");
        m.setTotal(5);
        m.setDefaultTablas();

    }
=======
>>>>>>> 4d88fc0 a

}
